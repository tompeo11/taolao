USE master
GO

DROP DATABASE IF EXISTS LICHBAYNHANVIEN
CREATE DATABASE LICHBAYNHANVIEN
GO

USE LICHBAYNHANVIEN
GO

DROP TABLE IF EXISTS NhanVien
CREATE TABLE NhanVien
(
	maNV NVARCHAR(4) PRIMARY KEY,
	ten NVARCHAR(15),
	dThoai NVARCHAR(12),
	luong FLOAT,
	loaiNV BIT
)
GO

DROP TABLE IF EXISTS LichBay
CREATE TABLE LichBay
(
	ngayDi DATETIME,
	maChB NVARCHAR(3),
	soHieu INT
	PRIMARY KEY (ngayDi,maChB)
)
GO

DROP TABLE IF EXISTS PhanCong
CREATE TABLE PhanCong
(
	maNV NVARCHAR(4),
	ngayDi DATETIME,
	maChB NVARCHAR(3)
	PRIMARY KEY (maNV, ngayDi,maChB)
)
GO

ALTER TABLE PhanCong
ADD CONSTRAINT FK_PhanCong_NhanVien
FOREIGN KEY (maNV)
REFERENCES NhanVien(maNV)
GO

ALTER TABLE PhanCong
ADD CONSTRAINT FK_PhanCong_LichBay
FOREIGN KEY (ngayDi, maChB)
REFERENCES LichBay(ngayDi, maChB)
GO



INSERT INTO NhanVien (maNV,ten,dThoai,luong,loaiNV)
VALUES 
	('1001','Huong',8330733,500000,'True'),
	('1002','Phong',8308117,450000,'True'),
	('1003','Quang',8324461,350000,'True'),
	('1004','Phuong',8308155,250000,'False'),
	('1005','Giao',8324467,500000,'False'),
	('1006','Chi',8120012,150000,'False'),
	('1007','Tam',8458188,500000,'False')
GO

INSERT INTO LichBay (ngayDi,maChB,soHieu)
VALUES 
	('20001031',100,11),
	('20001031',112,11),
	('20001031',334,10),
	('20001031',335,10),
	('20001101',112,21),
	('20001101',206,22),
	('20001101',334,10),
	('20001101',337,10),
	('20001101',395,23),
	('20001101',991,22)
GO

INSERT INTO PhanCong (maNV,ngayDi,maChB)
VALUES 
	('1001','20001031',100),
	('1003','20001031',100),
	('1003','20001101',337),
	('1004','20001031',100),
	('1004','20001101',337),
	('1006','20001101',991)
GO

SELECT * FROM NhanVien
SELECT * FROM LichBay
SELECT * FROM PhanCong